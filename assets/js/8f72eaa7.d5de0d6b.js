"use strict";(self.webpackChunkdssl_robots_website=self.webpackChunkdssl_robots_website||[]).push([[256],{2272:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>t,default:()=>u,frontMatter:()=>i,metadata:()=>a,toc:()=>c});var o=s(4848),r=s(8453);const i={slug:"gazebo_troubleshooting",title:"Gazebo Troubleshooting",authors:["CabbageDog"],tags:["hello"]},t="Intro",a={permalink:"/blog/gazebo_troubleshooting",editUrl:"https://dsslrobot.github.io/blog/2024-10-26-gazebo.md",source:"@site/blog/2024-10-26-gazebo.md",title:"Gazebo Troubleshooting",description:"Some common bugs for gazebo.",date:"2024-10-26T00:00:00.000Z",tags:[{inline:!1,label:"Hello",permalink:"/blog/tags/hello",description:"Hello tag description"}],readingTime:2.8,hasTruncateMarker:!0,authors:[{name:"Wei Bingchuan",title:"PhD Student",url:"https://github.com/glaciercoder",page:{permalink:"/blog/authors/cabbage-dog"},socials:{github:"https://github.com/glaciercoder"},imageURL:"/img/cabbage_dog.png",key:"CabbageDog"}],frontMatter:{slug:"gazebo_troubleshooting",title:"Gazebo Troubleshooting",authors:["CabbageDog"],tags:["hello"]},unlisted:!1,nextItem:{title:"A Test",permalink:"/blog/blog_test"}},l={authorsImageUrls:[void 0]},c=[{value:"Startup",id:"startup",level:2},{value:"Simultaion",id:"simultaion",level:2},{value:"Conclusion",id:"conclusion",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"Some common bugs for gazebo."}),"\n",(0,o.jsx)(n.p,{children:"Despite the popularity of many new simulators such as coppeliasim, Issac Gym, etc, Gazebo is still widely used due to its ROS-friendly features."}),"\n",(0,o.jsx)(n.p,{children:"However, since the release of Gazeb Ign, the support for Gazebo Classic is terminated. Since Gazebo Ign is not mature now and has few using examples to be learned from, this blog mainly aims at Gazebo Classic."}),"\n",(0,o.jsx)(n.h2,{id:"startup",children:"Startup"}),"\n",(0,o.jsx)(n.p,{children:"When you start gazebo from ROS launch, you may find gazebo is not started or not started properly. As far as I know, this may be caused by the following problem:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"No source"}),"\n",(0,o.jsxs)(n.p,{children:["Though there is no instruction for sourcing gazebo, I suggest sourcing ",(0,o.jsx)(n.code,{children:"setup.sh"})," for gazebo:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"source /usr/share/gazebo/setup.sh\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"A background gazebo process is running:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"htop # sudo apt install htop\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Check whether there is a process named ",(0,o.jsx)(n.code,{children:"gzserver"})," of ",(0,o.jsx)(n.code,{children:"gzclient"}),". If true, shut down them, using ",(0,o.jsx)(n.code,{children:"F9 + 9"})]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"gzserver"})," and ",(0,o.jsx)(n.code,{children:"gzclient"})," not properly setup"]}),"\n",(0,o.jsxs)(n.p,{children:["Gazboe comprises of ",(0,o.jsx)(n.code,{children:"gzserver"}),"(The background process to do simulation) and the ",(0,o.jsx)(n.code,{children:"gzclient"}),"(The GUI you see on your screen). Some launch file will directly launch gazebo using one launch action, but I strongly recommend setup ",(0,o.jsx)(n.code,{children:"gzserver"})," and ",(0,o.jsx)(n.code,{children:"gzclient"})," seperately, and set the ",(0,o.jsx)(n.code,{children:"headless"})," parameter to be dynamically configured. One example is:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:"start_gazebo_server_cmd = ExecuteProcess(\n    condition=IfCondition(use_simulator),\n    cmd=['gzserver', '-s', 'libgazebo_ros_init.so',\n         '-s', 'libgazebo_ros_factory.so', world],\n     output='screen')\n\nstart_gazebo_client_cmd = ExecuteProcess(\n    condition=IfCondition(PythonExpression(\n        [use_simulator, ' and not ', headless])),\n    cmd=['gzclient'],\n    output='screen')\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Port error"}),"\n",(0,o.jsxs)(n.p,{children:["Sometimes you will see an error about port such as ",(0,o.jsx)(n.code,{children:"Fast_RTPS"}),", this is because your another process is using this port or you set the weired network proxy. I suggest restart your computer and turn down your proxy and try again."]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"simultaion",children:"Simultaion"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"No model loaded"}),"\n",(0,o.jsxs)(n.p,{children:["Check your log carefully, typically this bug is caused by wrong urdf model or wrong spawn service call. Gazbo11 uses the following way to call ",(0,o.jsx)(n.code,{children:"spawn_entity"})," service:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:"spawn_entity_cmd = Node(package='gazebo_ros', executable='spawn_entity.py',\n         namespace=namespace,\n         arguments=[\n             \"-topic\", namespace + \"/robot_description\",\n             '-entity', robot['name'],\n             '-robot_namespace', robot['name'], #launch.substitutions.LaunchConfiguration('robot_name'),\n             '-x', str(robot['x_pos']),\n             '-y', str(robot['y_pos']),\n             '-z', str(robot['z_pos']),             \n         ],\n         parameters=[{'use_sim_time': use_sim_time}],\n         output='screen')\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Packages with ",(0,o.jsx)(n.code,{children:"xxxStamped"})," message doesn't work"]}),"\n",(0,o.jsxs)(n.p,{children:["This is typically caused by the clock. When you use a simulator(Not Only Gazebo!), you shoud set ",(0,o.jsx)(n.code,{children:"use_sim_time"})," to ",(0,o.jsx)(n.code,{children:"True"})," for ",(0,o.jsx)(n.strong,{children:"All Your Nodes!!!"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:"Your_node = Node(package='xxx', executable='xxx',\n         namespace=namespace,\n         arguments=[\n             xxx\n         ],\n         parameters=[{'use_sim_time': use_sim_time}],\n         output='screen')\n"})}),"\n",(0,o.jsxs)(n.p,{children:["When you enable ",(0,o.jsx)(n.code,{children:"use_sim_time"}),", you must be sure there is actually a clock signal on the topic ",(0,o.jsx)(n.code,{children:"/Clock"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-sh",children:"ros2 topic echo /Clock\n"})}),"\n",(0,o.jsx)(n.p,{children:"For Gazebo, you can insert a plugin to publish its clock to this topic:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:"bridge = Node(\n    package='ros_gz_bridge',\n    executable='parameter_bridge',\n    arguments=[\n        '/clock@rosgraph_msgs/msg/Clock@gz.msgs.Clock',  # Works fine\n    ],\n    output='screen'\n)\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Some services lost or not found"}),"\n",(0,o.jsx)(n.p,{children:"This is mainly caused by plugin not installed or not enabled. There are serveral places for plugin use:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Sensor plugin in model urdf","\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",children:'    <gazebo reference="$(arg namespace)/imu_link">\n    <sensor name="imu_sensor" type="imu">\n      <plugin filename="libgazebo_ros_imu_sensor.so" name="imu_plugin">\n        <ros>\n          <namespace>$(arg namespace)/imu</namespace>\n          <remapping>~/out:=$(arg namespace)/imu</remapping>\n        </ros>\n        <initial_orientation_as_reference>false</initial_orientation_as_reference>\n        <frame_name>$(arg namespace)/imu_link</frame_name>\n      </plugin>\n      xxx\n      </imu>\n    </sensor>\n  </gazebo>\n'})}),"\n"]}),"\n",(0,o.jsx)(n.li,{children:"Model plugin in model urdf"}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",children:'<gazebo>\n    <plugin name="turtlebot3_diff_drive" filename="libgazebo_ros_diff_drive.so">\n        xxx\n    </plugin>\n\n    <plugin name="turtlebot3_joint_state" filename="libgazebo_ros_joint_state_publisher.so">\n       xxx\n    </plugin>\n</gazebo>\n'})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["World plugin in ",(0,o.jsx)(n.code,{children:".sdf"})," file"]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-xml",children:'<plugin name="gazebo_ros_state" filename="libgazebo_ros_state.so">\n  <ros>\n    <namespace>/gazebo</namespace>\n  </ros>\n\n  <update_rate>10.0</update_rate>\n</plugin>\n'})}),"\n",(0,o.jsxs)(n.p,{children:["This world plugin provides services such as ",(0,o.jsx)(n.code,{children:"getEntityState"})]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,o.jsxs)(n.p,{children:["Troubleshooting for gazebo is ",(0,o.jsx)(n.a,{href:"https://robotics.stackexchange.com/",children:"Robotcis.stackexchange"}),". I strongly suggest the deprecation for gazebo and use more elegant simulator."]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>a});var o=s(6540);const r={},i=o.createContext(r);function t(e){const n=o.useContext(i);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);